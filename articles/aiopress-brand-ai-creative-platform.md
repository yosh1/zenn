---
title: "ブランドのトーンがぶれない生成AI、ハッカソンで作ってみた"
emoji: "🎨"
type: "idea"
topics: ["gch4", "googlecloud", "vertexai", "gemini", "firestore"]
published: true
publication_name: "aiosoken"
---

## はじめに

最近、生成AIでマーケティングコンテンツを作ることも増えてきました。1本1本の品質はそこそこ出ますが、トーンの一貫性がないという課題があります。月曜に作ったSNS投稿と金曜に作ったブログ記事で、まるで別人が書いたみたいになる。

ブランドガイドラインをプロンプトに貼れば多少マシにはなるけど、毎回やるのは現実的じゃありません。かといって放置すると「うちのブランドっぽくない」とフィードバックが飛んできます。

この課題をなんとかしたくて、[第4回 Agentic AI Hackathon with Google Cloud](https://zenn.dev/hackathons/google-cloud-japan-ai-hackathon-vol4) で「AIOプレス」を作りました。

## 解決する課題

もう少し具体的に書くと、こういう声をよく聞きます。

> SNS投稿、ブログ記事、営業資料… 全部自分で作らなきゃいけないけど、デザインもコピーも自信がない

> ChatGPT で文章は作れるようになったけど、毎回ブランドのトーンがバラバラになる

> 外注すると1案件で数万円。月に何十本もは出せない

汎用AIツールだと、プロンプトを打つたびにトーンやカラー、ターゲット像を伝え直さなければなりません。忘れれば出力がぶれる。毎回書くのは面倒。無個性なコンテンツが量産されるか、ブランドガイドラインとの突き合わせに人手がかかるか、どちらかです。

ブランドの情報を一回登録したら、あとは何を作ってもそのトーンが維持される。そういう仕組みがほしくて作りました。

## AIOプレスとは

ブランドのDNA──ミッション、ビジョン、トーン&マナー、カラーパレットなどを一度登録しておくと、そのブランドらしさを保ったままクリエイティブを生成できるプラットフォームです。

キャッチコピー、SNS投稿、ブログ記事、画像、プレゼン資料。ひとつのテーマを入れるだけで、これらをまとめて出力します。AIエージェントも載せていて、チャットで指示すればブランド情報の取得から生成、評価までを自律的に回してくれます。

## デモ動画

@[youtube](YOUR_VIDEO_ID_HERE)

## システムアーキテクチャ

![AIOプレス システムアーキテクチャ](/images/aiopress-architecture.png)

フロントエンドは Next.js の App Router で、バックエンドは Cloud Functions。AI周りは Vertex AI に寄せていて、テキスト生成に Gemini 2.0 Flash、画像生成に Imagen 3、アセット分析に Cloud Vision API を使っています。データは Firestore、ファイルは Cloud Storage、認証は Firebase Authentication。全部サーバーレスなので、使った分だけ課金される構成です。

UIは shadcn/ui で組んでいます。Radix UI ベースのコンポーネントが40種以上あるので、ダッシュボードやフォームを手早く組めました。スタイリングは Tailwind CSS です。

### 技術スタック

| レイヤー | 技術 | 役割 |
|---|---|---|
| フロントエンド | Next.js (App Router), shadcn/ui, Tailwind CSS | UI・ルーティング |
| ホスティング | Cloud Run (Firebase App Hosting) | Next.js のホスティング |
| バックエンド | Cloud Functions | 生成・解析・エージェント処理のAPI |
| テキスト生成 | Vertex AI - Gemini 2.0 Flash | コピー生成、スコア算出、推論エンジン |
| 画像生成 | Vertex AI - Imagen 3 | ブランドの世界観を反映した画像 |
| 画像解析 | Cloud Vision API | 色分析、OCR、ラベル・ロゴ検出 |
| 認証 | Firebase Authentication | Google OAuth・メールパスワード認証 |
| データベース | Cloud Firestore | ブランドDNA・クリエイティブ等の永続化 |
| ストレージ | Cloud Storage for Firebase | アセット・生成画像の保存・配信 |

## 主要機能

### ブランドDNAの登録

まずブランドの構成要素を登録するところから始まります。

```
Brand DNA
├── Mission（存在意義）
├── Vision（目指す世界）
├── Value Proposition（価値提案）
├── Target Audience（ペルソナ）
├── Tone & Manner（語り口）
├── Personality（ブランドの人格）
├── Keywords（キーワード群）
├── Color Palette（ブランドカラー）
├── Typography（フォント体系）
└── Design Principles（デザイン原則）
```

手で全部入力するのは大変なので、WebサイトのURLやPDF、ロゴ画像をアップロードすれば、GeminiとCloud Vision APIが連携してブランド特性を自動抽出し、初期値を埋めてくれます。ここだけでもかなり手間が省けます。

### クリエイティブ生成

登録したDNAは、すべての生成リクエストに自動で差し込まれます。ユーザーはテーマだけ入力すればよくて、毎回ブランドの説明をプロンプトに書く必要がありません。

キャッチコピーなら3パターン、SNS投稿ならハッシュタグ付き、ブログ記事ならSEOを意識した構成、画像ならブランドカラーを反映したビジュアル。フォーマットごとに生成の仕方を変えています。

生成と同時にブランドフィットスコアを0〜100点で算出します。ミッションとの整合性、ターゲットへの適切さ、トーン&マナーの反映度、創造性の4軸で25点ずつ。スコアが低ければ改善ポイントも一緒に出るので、どこがずれたか一目でわかります。

### AIエージェント

ここが一番こだわった部分です。Gemini 2.0 Flash の Function Calling を使って、ReAct パターンのエージェントを自前で実装しました。

ユーザーがチャットで指示を出すと、エージェントが `get_brand_info` でブランド情報を取得し、`search_past_creatives` で過去の制作物を参照し、`generate_text_creative` や `generate_image` で新しいクリエイティブを作り、`evaluate_brand_fit` でスコアを確認する。この一連の流れを、最大10ターンまで自律的に回します。

会話履歴は Firestore に保存しているので、途中で離れてもセッションを再開できます。

### フィードバックで磨く

生成したクリエイティブに対して、チャット形式でフィードバックを送れます。

```
[ユーザー] もう少しカジュアルなトーンにしたい。絵文字も使って。
    ↓
[AI] ブランドDNAのトーン設定と照合しつつ、カジュアル度を上げた改善案を3パターン生成
    ↓
[ユーザー] 2番目がいい。ただし最後の一文だけ変えたい。
    ↓
[AI] 部分修正を反映した最終案を提示
```

特定の箇所をハイライトしてピンポイントに指摘することもできます。何往復かやりとりすると、最初の出力とはかなり違う仕上がりになります。

### そのほかの機能

- **アセット分析** ── ロゴや参考画像をアップロードすると、Cloud Vision API が色、テキスト、ラベル、ロゴを自動検出してブランドDNAに反映します
- **プレゼン資料** ── ブランドカラーとフォントが反映された PPTX をそのまま生成。営業資料にすぐ使えます
- **印刷連携** ── Epson Connect API でプリンターに直接送れるので、チラシやポスターもすぐ刷れます
- **メンバー管理** ── OWNER、ADMIN、MEMBER の3ロールでアクセス制御。チーム運用に対応しています

## 技術的なこだわり

### エージェントを自前で組んだ話

ADK みたいな既存フレームワークは使いませんでした。Gemini の Function Calling を直接叩いて ReAct ループを実装しています。思考→行動→観察のサイクルを自分でハンドリングするので、ツールの実行順やエラー時のリトライを細かく制御できます。

正直、ハッカソンの短期間でフレームワークを学ぶ余裕がなかったのもあります。プリミティブに組んだほうが、挙動を全部把握できて結果的に速かったです。

### ブランドの人格をプロンプトに埋める苦労

ここが一番ハマったところです。ブランドDNAをただテキストとしてプロンプトに貼るだけだと、出力にほとんど反映されません。

試行錯誤の末、ミッション、ビジョン、パーソナリティ、トーンをそれぞれ構造化して、生成タイプごとに注入のしかたを変えるテンプレートシステムを作りました。「このブランドはどういう人格で、どう振る舞うか」をAIに伝えることで、ようやく出力のトーンが安定するようになりました。

### セキュリティ

Firestore Security Rules でドキュメント単位のアクセスを制御し、Cloud Functions の全エンドポイントで `verifyBrandMember` を通しています。ブランドごとにメンバーシップを管理しているので、招待されていないブランドのデータには触れません。

## 今後の展望

エージェントは今のところカスタム実装ですが、ADK に載せ替えればもっと柔軟にツールを追加できるはずです。定期的にクリエイティブを生成してSNSに自動投稿するところまでいけたら、かなり実用的になると思っています。

あとは複数ブランドの横断管理と、生成パターンのA/Bテスト。どのコピーが刺さったかまでフィードバックが回るようになれば、DNAの定義自体もアップデートしていけます。

## まとめ

ブランドのトーンを維持したまま、クリエイティブを量産したい。そのためにブランドDNAの一元管理とAIエージェントを組み合わせたプラットフォームを作りました。

ハッカソン期間内で全部を磨ききれたわけではありませんが、毎回プロンプトにブランド情報を書き直す面倒くささからは解放されるものができました。Vertex AI の生成系APIとFirebaseのサーバーレス基盤のおかげで、この規模のアプリでも一通り動くところまで持っていけたのは助かりました。

これからもこのプラットフォームをどんどん改善していきたいと思います。

